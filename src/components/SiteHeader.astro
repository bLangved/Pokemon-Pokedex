<header>
  <nav class="navbar navbar-dark bg-dark fixed-top">
    <div class="container-fluid d-flex align-items-center">
      <a class="navbar-brand" href="/"
        ><img
          src="/public/logo/pokèdex4life_v1.png"
          height="48"
          width="172"
        /></a
      >
      <button
        class="navbar-toggler"
        type="button"
        data-bs-toggle="offcanvas"
        data-bs-target="#offcanvasDarkNavbar"
        aria-controls="offcanvasDarkNavbar"
        aria-label="Toggle navigation"
      >
        <span class="navbar-toggler-icon"></span>
      </button>
      <div
        class="offcanvas offcanvas-end text-bg-dark"
        tabindex="-1"
        id="offcanvasDarkNavbar"
        aria-labelledby="offcanvasDarkNavbarLabel"
      >
        <div class="offcanvas-header">
          <h5 class="offcanvas-title" id="offcanvasDarkNavbarLabel">
            Gotta catch em all!
          </h5>
          <button
            type="button"
            class="btn-close btn-close-white"
            data-bs-dismiss="offcanvas"
            aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
          <form class="d-flex mb-3" role="search">
            <input
              class="form-control me-2"
              type="search"
              placeholder="Search for Pokémon"
              aria-label="Search"
            />
            <button class="btn btn-success" type="submit">Search</button>
          </form>
          <ul class="navbar-nav justify-content-end flex-grow-1 pe-3">
            <li class="nav-item">
              <a class="nav-link active" aria-current="page" href="/">Home</a>
            </li>
            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="#"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                Pokemon generations
              </a>
              <ul
                class="dropdown-menu dropdown-menu-dark dropdown-generations"
                id="navPokeGen"
              >
                <li class="dropdown-item py-2" id="1PokeGen">1.gen</li>
                <li class="dropdown-item py-2" id="2PokeGen">2.gen</li>
                <li class="dropdown-item py-2" id="3PokeGen">3.gen</li>
                <li class="dropdown-item py-2" id="4PokeGen">4.gen</li>
                <li class="dropdown-item py-2" id="5PokeGen">5.gen</li>
                <li class="dropdown-item py-2" id="6PokeGen">6.gen</li>
                <li class="dropdown-item py-2" id="7PokeGen">7.gen</li>
                <li class="dropdown-item py-2" id="8PokeGen">8.gen</li>
                <li class="dropdown-item py-2" id="9PokeGen">9.gen</li>
              </ul>
            </li>
          </ul>
        </div>
        <div class="offcanvas-end mt-auto ps-3 mb-4">
          <div>The data on this site is retrieved by using the pokéAPI</div>
          <a href="https://pokeapi.co/" class="link-light">Check it out here</a>
        </div>
      </div>
    </div>
  </nav>

  <style lang="scss">
    header {
      // height: 96px;
      nav {
      }
      .dropdown-generations {
        cursor: pointer;
      }
    }
  </style>

  <script>
    // Used for hiding the navbar when generations are loaded in
    import { Offcanvas } from 'bootstrap';
    document.addEventListener('DOMContentLoaded', function () {
      const offcanvasElement = document.querySelector('#offcanvasDarkNavbar');
      const bsOffcanvas = new Offcanvas(offcanvasElement);
      const dropdownItems = document.querySelectorAll(
        '#navPokeGen .dropdown-item',
      );
      dropdownItems.forEach((item) => {
        item.addEventListener('click', () => {
          bsOffcanvas.hide();
        });
      });
    });
  </script>

  <script>
    function updateTheme() {
      const prefersDark = window.matchMedia(
        '(prefers-color-scheme: dark)',
      ).matches;
      const navbar = document.querySelector('.navbar');
      const offcanvas = document.querySelector('.offcanvas');
      const btnClose = document.querySelector('.offcanvas .btn-close');
      const apiLink = document.querySelector('.offcanvas-end .link-light');

      if (prefersDark) {
        navbar.classList.remove('navbar-dark', 'bg-dark');
        navbar.classList.add('navbar-light', 'bg-light');
        offcanvas.classList.remove('text-bg-dark');
        offcanvas.classList.add('text-bg-light');
        btnClose.classList.remove('btn-close-white');
        btnClose.classList.add('btn-close-dark');
        apiLink.classList.remove('link-light');
        apiLink.classList.add('link-dark');
      } else {
        navbar.classList.remove('navbar-light', 'bg-light');
        navbar.classList.add('navbar-dark', 'bg-dark');
        offcanvas.classList.remove('text-bg-light');
        offcanvas.classList.add('text-bg-dark');
        btnClose.classList.remove('btn-close-dark');
        btnClose.classList.add('btn-close-white');
        apiLink.classList.remove('link-dark');
        apiLink.classList.add('link-light');
      }
    }

    updateTheme();

    const darkModeMediaQuery = window.matchMedia(
      '(prefers-color-scheme: dark)',
    );
    const lightModeMediaQuery = window.matchMedia(
      '(prefers-color-scheme: light)',
    );

    darkModeMediaQuery.addEventListener('change', updateTheme);
    lightModeMediaQuery.addEventListener('change', updateTheme);
  </script>
</header>
